<div class="canary-details" ng-controller="CanaryExecutionDetailsCtrl as canaryDetailsCtrl">
  <execution-details-section-nav sections="configSections"></execution-details-section-nav>

  <div class="step-section-details" ng-if="detailsSection === 'canarySummary'">
    <div class="row">
      <div class="col-md-12 canary-summary">
        <div class="score score-large">
          <canary-score health="canary.health.health"
                        result="canary.canaryResult.overallResult"
                        score="canary.canaryResult.overallScore"></canary-score>
        </div>
        <div class="canary-summary-section">
          <strong>Last updated&nbsp;:&nbsp;&nbsp;</strong>
          {{ canary.canaryResult.lastUpdated | timestamp }}
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <table class="table">
          <tbody>
          <tr>
            <td style="border-top: none !important;"><strong>Deployment</strong></td>
            <td style="border-top: none !important;"><strong>Canary Result</strong></td>
            <td style="border-top: none !important;"><strong>Duration</strong></td>
            <td style="border-top: none !important;"><strong>Report</strong></td>
            <td style="border-top: none !important;"><strong>Last Updated</strong></td>
          </tr>
          <tr ng-repeat="canaryDeployment in canaryDeployments">
            <td>
              <strong>{{ canaryDeployment.canaryCluster.region }}</strong>
            </td>
            <td>
              <canary-score result="canaryDeployment.canaryResult.result"
                            score="canaryDeployment.canaryResult.score"
                            health="canaryDeployment.health.health"></canary-score>
            </td>
            <td>
              <span ng-if="canaryDeployment.canaryResult.timeDuration.durationString">
                {{ canaryDeployment.canaryResult.timeDuration.durationString }}
              </span>
              <span ng-if="!canaryDeployment.canaryResult.timeDuration.durationString">
                -
              </span>
            </td>
            <td>
              <a ng-if="canaryDeployment.canaryAnalysisResult.canaryReportURL"
                 target="_blank" ng-href="{{canaryDeployment.canaryAnalysisResult.canaryReportURL}}">
                Canary Report
              </a>
            </td>
            <td>
              <span ng-if="canaryDeployment.canaryAnalysisResult.lastUpdated">
                {{ canaryDeployment.canaryResult.lastUpdated | timestamp}}
              </span>
              <span ng-if="!canaryDeployment.canaryAnalysisResult.lastUpdated">
                -
              </span>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="step-section-details" ng-if="detailsSection === 'canaryConfig'">
    <div class="row">
      <div class="col-md-12">
        <div class="row">
          <div class="col-md-4"><h5>Name</h5></div>
          <div class="col-md-6"><h5 ng-bind="canaryConfig.name"></h5></div>
        </div>
        <div class="horizontal-rule"></div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 canary-config-section">
        <div class="row">
          <div class="col-md-4 sm-label-left compact">Baseline</div>
          <div class="col-md-6"><account-tag account="baseline.account" pad="right"></account-tag> {{baseline.cluster}}</div>
        </div>
        <div class="row">
          <div class="col-md-4 sm-label-left compact">Duration</div>
          <div class="col-md-6">{{canaryConfig.lifetimeHours}} hours</div>
        </div>
        <div class="row">
          <div class="col-md-4 sm-label-left compact">Success Criteria</div>
          <div class="col-md-6">{{canaryConfig.canarySuccessCriteria.canaryResultScore}}</div>
        </div>
        <div class="row">
          <div class="col-md-4 sm-label-left compact">Result Strategy</div>
          <div class="col-md-6">{{canaryConfig.combinedCanaryResultStrategy | lowercase}}</div>
        </div>
      </div>
      <div class="col-md-12 canary-config-section">
        <h5>Analysis Config</h5>
        <div class="horizontal-rule"></div>
        <div class="row">
          <div class="col-md-4 sm-label-left compact">Config Name</div>
          <div class="col-md-6">{{canaryConfig.canaryAnalysisConfig.name}}</div>
        </div>
        <div class="row">
          <div class="col-md-4 sm-label-left compact">Warmup Period</div>
          <div class="col-md-6">{{canaryConfig.canaryAnalysisConfig.beginCanaryAnalysisAfterMins}} minutes</div>
        </div>
        <div class="row">
          <div class="col-md-4 sm-label-left compact">Interval</div>
          <div class="col-md-6">{{canaryConfig.canaryAnalysisConfig.canaryAnalysisIntervalMins}} minutes</div>
        </div>
        <div class="row">
          <div class="col-md-4 sm-label-left compact">Notification Hours</div>
          <div class="col-md-6">{{canaryConfig.canaryAnalysisConfig.notificationHours.join(', ')}}</div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 canary-config-section">
        <h5>Health Check</h5>
        <div class="horizontal-rule"></div>
        <div class="row">
          <div class="col-md-4 sm-label-left compact">Minimum Canary Score</div>
          <div class="col-md-6">{{canaryConfig.canaryHealthCheckHandler.minimumCanaryResultScore}}</div>
        </div>
      </div>
    </div>
  </div>

  <div class="step-section-details" ng-if="detailsSection === 'taskStatus'">
    <div class="row">
      <execution-step-details item="stage"></execution-step-details>
    </div>
  </div>
</div>
